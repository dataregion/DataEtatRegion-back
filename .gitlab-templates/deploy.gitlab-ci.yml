.default-deploy-integ: &default-deploy-integ
  rules:
    - if: '$_ENABLE_DEPLOY_FOR_INTEG == "âœ…"'
    - if: '$_ENABLE_DEPLOY_FOR_INTEG == "âš™ï¸"'
      when: manual
    - when: never

.default-deploy-pp-p: &default-deploy-pp-p
  rules:
    - if: '$_ENABLE_DEPLOY_FOR_PP_AND_P == "âœ…"'
      when: manual # XXX tout le temps manuel
    - if: '$_ENABLE_DEPLOY_FOR_PP_AND_P == "âš™ï¸"'
      when: manual
    - when: never
  
"ğŸ£ deploy data-transform on integration":
  <<: *default-deploy-integ
  stage: "ğŸ£ deploy"
  trigger:
    project: SIBSGAR/DataRegateNum/stack
    branch: main
    strategy: depend
    forward:
      yaml_variables: true
      pipeline_variables: false
  variables: 
    DO_DEPLOY: "âœ…"
    DO_DEPLOY_environment: "integ"
    UPSTREAM_PROJECT: $CI_PROJECT_PATH

"ğŸš¨ deploy data-transform on preprod":
  <<: *default-deploy-pp-p
  stage: "ğŸ£ deploy"
  trigger:
    project: SIBSGAR/DataRegateNum/stack
    branch: main
    forward:
      yaml_variables: true
      pipeline_variables: false
  variables:
    DO_DEPLOY: "âœ…"
    DO_DEPLOY_environment: "preprod"
    UPSTREAM_PROJECT: $CI_PROJECT_PATH

"ğŸš¨ deploy data-transform on prod":
  <<: *default-deploy-pp-p
  stage: "ğŸ£ deploy"
  trigger:
    project: SIBSGAR/DataRegateNum/stack
    branch: main
    forward:
      yaml_variables: true
      pipeline_variables: false
  variables:
    DO_DEPLOY: "âœ…"
    DO_DEPLOY_environment: "prod"
    UPSTREAM_PROJECT: $CI_PROJECT_PATH